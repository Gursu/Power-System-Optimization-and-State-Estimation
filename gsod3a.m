%x = [0; 1; 1];

z = [0.92; 1.02; 0.605; 0.598; 0.305];

R = zeros(5);
R(1,1) = 0.01^2;
R(2,2) = 0.01^2;
R(3,3) = 0.02^2;
R(4,4) = 0.015^2;
R(5,5) = 0.02^2;

e = [z(1)-x(2); z(2)-x(3); z(3)-(25/6*x(3)^2-4*x(3)*x(2)*cos(x(1))); z(4)-(-4*x(3)*x(2)*sin(x(1))); z(5)-(4*x(2)^2-4*x(3)*x(2)*cos(x(1)))];

Hx = [0 1 0; 0 0 1; 4*x(3)*x(2)*sin(x(1)) -4*x(3)*cos(x(1)) 25/3*x(3)-4*x(2)*cos(x(1)); -4*x(3)*x(2)*cos(x(1)) -4*x(3)*sin(x(1)) -4*x(2)*sin(x(1)); 4*x(3)*x(2)*sin(x(1)) 8*x(2)-4*x(3)*cos(x(1)) -4*x(2)*cos(x(1))];

Gx = Hx' * inv(R) * Hx;

x = x + inv(Gx) * Hx' * inv(R) * e